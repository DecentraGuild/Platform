import{t as g,s as $,f as F,e as P}from"./DnknCDuH.js";import{e as T,o as d,c as f,a as _,t as p,g as m,h as k,_ as L,S as R,O as h,D as E,f as I,r as S}from"./Cuem3LDA.js";import"./Cov751Ou.js";import{a as U}from"./BBhsNU_X.js";const z={class:"token-amount"},V={class:"token-amount__value"},W={class:"token-amount__label"},x={key:0,class:"token-amount__mint"},H=T({__name:"TokenAmountWithLabel",props:{amount:{},decimals:{default:0},symbol:{},name:{},mint:{},showMintShort:{type:Boolean,default:!1}},setup(e){const t=e;function a(s){return s==null||!Number.isFinite(s)?"0":Number.isInteger(s)?String(s):s.toFixed(6).replace(/\.?0+$/,"")}const o=k(()=>a(t.amount)),n=k(()=>g(t.mint,6,4)),r=k(()=>{const s=t.decimals??0,c=$(t.symbol),i=$(t.name);return s===0?i||c||n.value:c||i||n.value});return(s,c)=>(d(),f("span",z,[_("span",V,p(o.value),1),_("span",W,p(r.value),1),e.showMintShort&&(e.symbol||e.name)?(d(),f("span",x," ("+p(n.value)+") ",1)):m("",!0)]))}}),Z=L(H,[["__scopeId","data-v-deb999b2"]]),K={key:0},O=T({__name:"StatusBanner",props:{variant:{default:"info"},message:{},retry:{type:Boolean,default:!1},retryLabel:{default:"Retry"}},emits:["retry"],setup(e){return(t,a)=>(d(),f("div",{class:R(["status-banner",`status-banner--${e.variant}`])},[h(t.$slots,"default",{},()=>[e.message?(d(),f("p",K,p(e.message),1)):m("",!0)]),t.$slots.hint?h(t.$slots,"hint",{key:0},void 0):m("",!0),t.$slots.action?h(t.$slots,"action",{key:1},()=>[e.retry?(d(),f("button",{key:0,type:"button",class:"status-banner__retry",onClick:a[0]||(a[0]=o=>t.$emit("retry"))},p(e.retryLabel),1)):m("",!0)]):m("",!0)],2))}}),ee=L(O,[["__scopeId","data-v-98ea139c"]]);function v(e,t){if("publicKey"in e&&"account"in e){const o=e.account;return(t==="deposit"?o.depositToken:o.requestToken).toBase58()}const a=e.account;return t==="deposit"?a.depositToken:a.requestToken}function j(e){return(e.account??e.account).tokensDepositRemaining}function G(e){const t=e.account??e.account;return P(t.price)}function D(e,t){if(!t)return 0;const a=t.currencyMints?.find(n=>n.mint===e);if(a?.decimals!=null)return a.decimals;const o=t.splAssetMints?.find(n=>n.mint===e);return o?.decimals!=null?o.decimals:0}function te(e){const t=E(),{fetchMetadata:a}=U(),o=S(null),n=S(null),r=S(!0),s=k(()=>{const i=e.value;if(!i)return null;const y=v(i,"deposit"),b=v(i,"request"),u=t.marketplaceSettings,l=D(y,u),A=D(b,u),M=Math.max(0,Math.min(18,l)),B=A,C=j(i),w=F(C,M),q=G(i),N=w*q;return{depositAmount:w,depositSymbol:o.value?.symbol??null,depositName:o.value?.name??null,depositMintShort:g(y,6,4),depositDecimals:M,requestAmount:N,requestSymbol:n.value?.symbol??null,requestName:n.value?.name??null,requestMintShort:g(b,6,4),requestDecimals:B,pricePerUnit:q,priceSymbol:n.value?.symbol??null,loading:r.value}});async function c(){const i=e.value;if(!i){r.value=!1;return}r.value=!0;const y=v(i,"deposit"),b=v(i,"request");try{const[u,l]=await Promise.all([a(y),a(b)]);o.value=u?{name:u.name,symbol:u.symbol}:null,n.value=l?{name:l.name,symbol:l.symbol}:null}finally{r.value=!1}}return I(e,c,{immediate:!0}),{data:s,load:c}}function ne(e){function t(n,r){const s=e.value?{tenant:e.value,escrow:n}:{escrow:n};return r?.tab&&(s.tab=r.tab),{path:"/market",query:s}}function a(n){const r=typeof window<"u"?window.location.origin:"",s=e.value?`/market/escrow/${n}?tenant=${e.value}`:`/market/escrow/${n}`;return`${r}${s}`}function o(n){const r=a(n);typeof navigator<"u"&&navigator.clipboard&&navigator.clipboard.writeText(r)}return{escrowLink:t,shareUrl:a,copyShareLink:o}}export{ee as S,Z as T,ne as a,te as u};
