import{e as w,o as d,c as u,t as b,h as C,a as k,i as _,_ as x,j as I,k as M,l as $,f as N,w as f,g as e,b as r,F as U,d as V,m as T,r as y,n as A}from"./DCqABwCI.js";import{B as h}from"./RF0-wjs3.js";import{C as F,u as P}from"./DA7ovkCv.js";import{P as j}from"./4dOpxbBZ.js";import{C as E}from"./DPRGbT8j.js";const G={class:"text-input"},O=["for"],D=["id","type","value","placeholder","disabled"],L={key:1,class:"text-input__error"},R=w({__name:"TextInput",props:{modelValue:{},label:{},type:{default:"text"},placeholder:{},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(n){const t=_(()=>`input-${Math.random().toString(36).slice(2)}`);return(g,p)=>(d(),u("div",G,[n.label?(d(),u("label",{key:0,for:t.value,class:"text-input__label"},b(n.label),9,O)):C("",!0),k("input",{id:t.value,type:n.type,value:n.modelValue,placeholder:n.placeholder,disabled:n.disabled,class:"text-input__field",onInput:p[0]||(p[0]=i=>g.$emit("update:modelValue",i.target.value))},null,40,D),n.error?(d(),u("p",L,b(n.error),1)):C("",!0)]))}}),c=x(R,[["__scopeId","data-v-9c48a899"]]),q={key:0,class:"onboard-form__error"},J=w({__name:"onboard",setup(n){const t=I(),g=P(),p=M(),i=y(!1);$(()=>{t.fetchMe(),t.refreshConnectorState()});const a=A({slug:"",name:"",description:"",logo:"",primaryColor:"#00951a"}),v=y(!1),m=y(null);async function S(s){await t.connectAndSignIn(s)&&(i.value=!1)}async function B(){if(t.wallet.value){if(!a.slug||!a.name){m.value="Slug and name are required";return}v.value=!0,m.value=null;try{const s=g.value,o=await fetch(`${s}/api/v1/tenants`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({slug:a.slug,name:a.name,description:a.description||void 0,branding:{logo:a.logo||void 0,theme:a.primaryColor?{colors:{primary:{main:a.primaryColor}}}:void 0},modules:[{id:"admin",enabled:!0}]})});if(!o.ok){const l=await o.json().catch(()=>({}));throw new Error(l.error??"Failed to create")}await p.push("/directory")}catch(s){m.value=s instanceof Error?s.message:"Failed to create org"}finally{v.value=!1}}}return(s,o)=>(d(),N(e(j),{title:"Create org"},{default:f(()=>[r(e(F),null,{default:f(()=>[e(t).wallet.value?(d(),u("form",{key:1,class:"onboard-form",onSubmit:T(B,["prevent"])},[r(e(c),{modelValue:e(a).slug,"onUpdate:modelValue":o[2]||(o[2]=l=>e(a).slug=l),label:"Slug",placeholder:"my-dguild"},null,8,["modelValue"]),r(e(c),{modelValue:e(a).name,"onUpdate:modelValue":o[3]||(o[3]=l=>e(a).name=l),label:"Name",placeholder:"My dGuild"},null,8,["modelValue"]),r(e(c),{modelValue:e(a).description,"onUpdate:modelValue":o[4]||(o[4]=l=>e(a).description=l),label:"Description",placeholder:"Our community hub"},null,8,["modelValue"]),r(e(c),{modelValue:e(a).logo,"onUpdate:modelValue":o[5]||(o[5]=l=>e(a).logo=l),label:"Logo URL",placeholder:"https://..."},null,8,["modelValue"]),r(e(c),{modelValue:e(a).primaryColor,"onUpdate:modelValue":o[6]||(o[6]=l=>e(a).primaryColor=l),label:"Primary color (hex)",placeholder:"#00951a"},null,8,["modelValue"]),e(m)?(d(),u("div",q,b(e(m)),1)):C("",!0),r(e(h),{type:"submit",variant:"primary",disabled:e(v)},{default:f(()=>[...o[9]||(o[9]=[V("Create",-1)])]),_:1},8,["disabled"])],32)):(d(),u(U,{key:0},[o[8]||(o[8]=k("p",{class:"onboard-form__prompt"}," Connect your wallet and sign in to create a dGuild. ",-1)),r(e(h),{variant:"primary",onClick:o[0]||(o[0]=l=>i.value=!0)},{default:f(()=>[...o[7]||(o[7]=[V(" Connect wallet ",-1)])]),_:1}),r(e(E),{open:e(i),title:"Connect wallet",description:"Choose a wallet to sign in and create your dGuild.",connectors:e(t).connectorState.value.connectors,loading:e(t).loading.value,error:e(t).error.value,onClose:o[1]||(o[1]=l=>i.value=!1),onSelect:S},null,8,["open","connectors","loading","error"])],64))]),_:1})]),_:1}))}}),X=x(J,[["__scopeId","data-v-07d0618e"]]);export{X as default};
