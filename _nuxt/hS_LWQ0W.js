import{a4 as p,a5 as T}from"./DhkfeLsH.js";import{T as _,g as C}from"./DAaVrNXw.js";const f="So11111111111111111111111111111111111111112",w=6e4,m=new Map;function h(t,n){return`${t}:${n}`}function y(t,n){const e=h(t,n),o=m.get(e);return o?Date.now()-o.fetchedAt>w?(m.delete(e),null):o.balances:null}function O(t,n,e){m.set(h(t,n),{balances:e,fetchedAt:Date.now()})}async function I(t,n,e,o){if(e.size===0)return[];{const a=y(t,n);if(a)return a}const i=new p(t),r=new T(n),s=[],[A,d]=await Promise.all([i.getParsedTokenAccountsByOwner(r,{programId:_}).catch(()=>({value:[]})),i.getParsedTokenAccountsByOwner(r,{programId:C}).catch(()=>({value:[]}))]),g=[...A.value??[],...d.value??[]],l=new Set;for(const a of g){const c=a.account.data.parsed?.info?.mint;if(!c||!e.has(c)||l.has(c))continue;const u=a.account.data.parsed?.info?.tokenAmount;u&&(l.add(c),s.push({mint:c,amount:u.amount,decimals:u.decimals??0,uiAmount:u.uiAmount??null}))}if(e.has(f))try{const a=await i.getBalance(r),c=a/1e9;(c>0||!l.has(f))&&s.push({mint:f,amount:a.toString(),decimals:9,uiAmount:c})}catch{}return O(t,n,s),s}export{I as f};
