import{M as w,B as E}from"./D7-ehNRZ.js";import{_ as C,o as s,c as r,r as T,e as I,t as y,f as v,a as t,g as x,d as S,h as N,i as O,j,w as g,n as $,k as e,b as u,F as M,l as F,m as h,p as L,q as P,s as D}from"./CSXcdl4R.js";import{P as R}from"./Ce05UpnU.js";const A={},G={class:"card"};function q(o,i){return s(),r("div",G,[T(o.$slots,"default",{},void 0)])}const B=C(A,[["render",q],["__scopeId","data-v-ac27e643"]]),z={class:"text-input"},H=["for"],J=["id","type","value","placeholder","disabled"],K={key:1,class:"text-input__error"},Q=I({__name:"TextInput",props:{modelValue:{},label:{},type:{default:"text"},placeholder:{},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(o){const i=x(()=>`input-${Math.random().toString(36).slice(2)}`);return(c,p)=>(s(),r("div",z,[o.label?(s(),r("label",{key:0,for:i.value,class:"text-input__label"},y(o.label),9,H)):v("",!0),t("input",{id:i.value,type:o.type,value:o.modelValue,placeholder:o.placeholder,disabled:o.disabled,class:"text-input__field",onInput:p[0]||(p[0]=_=>c.$emit("update:modelValue",_.target.value))},null,40,J),o.error?(s(),r("p",K,y(o.error),1)):v("",!0)]))}}),f=C(Q,[["__scopeId","data-v-128e176b"]]),W={class:"toggle"},X=["checked","disabled"],Y={key:0,class:"toggle__label"},Z=I({__name:"Toggle",props:{modelValue:{type:Boolean},label:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(o){return(i,c)=>(s(),r("label",W,[t("input",{type:"checkbox",checked:o.modelValue,disabled:o.disabled,class:"toggle__input",onChange:c[0]||(c[0]=p=>i.$emit("update:modelValue",p.target.checked))},null,40,X),c[1]||(c[1]=t("span",{class:"toggle__track"},null,-1)),i.$slots.default||o.label?(s(),r("span",Y,[T(i.$slots,"default",{},()=>[S(y(o.label),1)])])):v("",!0)]))}}),ee=C(Z,[["__scopeId","data-v-3b20ef0c"]]),ae={class:"admin"},le={class:"admin__tabs"},ne={key:0,class:"admin__panel"},oe={key:1,class:"admin__panel"},te={key:2,class:"admin__panel"},de={class:"admin__actions"},se={key:0,class:"admin__error"},re=I({__name:"admin",setup(o){const i=N(),c=D(),p=x(()=>i.tenant),_=x(()=>i.slug),m=h("general"),k=h(!1),V=h(null),l=L({name:"",description:"",branding:{logo:"",primaryColor:"",secondaryColor:""},modulesById:{}});O(p,d=>{d&&(l.name=d.name??"",l.description=d.description??"",l.branding.logo=d.branding?.logo??"",l.branding.primaryColor=d.branding?.theme?.colors?.primary?.main??"",l.branding.secondaryColor=d.branding?.theme?.colors?.secondary?.main??"",l.modulesById=Object.fromEntries((d.modules??[]).map(a=>[a.id,a.enabled])))},{immediate:!0});async function U(){if(_.value){k.value=!0,V.value=null;try{const d=(p.value?.modules??[]).map(b=>({...b,enabled:l.modulesById[b.id]??b.enabled})),a=await fetch(`${c.public.apiUrl}/api/v1/tenant/${_.value}/settings`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:l.name,description:l.description,branding:{logo:l.branding.logo,theme:{colors:{primary:l.branding.primaryColor?{main:l.branding.primaryColor}:void 0,secondary:l.branding.secondaryColor?{main:l.branding.secondaryColor}:void 0}}},modules:d})});if(!a.ok){const b=await a.json().catch(()=>({}));throw new Error(b.error??"Failed to save")}const n=await a.json();i.setTenant(n.tenant),P().loadTheme(n.tenant.branding?.theme??{},n.tenant.branding)}catch(d){V.value=d instanceof Error?d.message:"Failed to save"}finally{k.value=!1}}}return(d,a)=>(s(),j(e(R),{title:"Admin"},{default:g(()=>[t("div",ae,[t("ul",le,[t("li",null,[t("button",{class:$({active:e(m)==="general"}),onClick:a[0]||(a[0]=n=>m.value="general")}," General ",2)]),t("li",null,[t("button",{class:$({active:e(m)==="branding"}),onClick:a[1]||(a[1]=n=>m.value="branding")}," Branding ",2)]),t("li",null,[t("button",{class:$({active:e(m)==="modules"}),onClick:a[2]||(a[2]=n=>m.value="modules")}," Modules ",2)])]),e(m)==="general"?(s(),r("div",ne,[u(e(B),null,{default:g(()=>[a[8]||(a[8]=t("h3",null,"General",-1)),u(e(f),{modelValue:e(l).name,"onUpdate:modelValue":a[3]||(a[3]=n=>e(l).name=n),label:"Name"},null,8,["modelValue"]),u(e(f),{modelValue:e(l).description,"onUpdate:modelValue":a[4]||(a[4]=n=>e(l).description=n),label:"Description"},null,8,["modelValue"])]),_:1})])):e(m)==="branding"?(s(),r("div",oe,[u(e(B),null,{default:g(()=>[a[9]||(a[9]=t("h3",null,"Branding",-1)),u(e(f),{modelValue:e(l).branding.logo,"onUpdate:modelValue":a[5]||(a[5]=n=>e(l).branding.logo=n),label:"Logo URL"},null,8,["modelValue"]),u(e(f),{modelValue:e(l).branding.primaryColor,"onUpdate:modelValue":a[6]||(a[6]=n=>e(l).branding.primaryColor=n),label:"Primary color (hex)"},null,8,["modelValue"]),u(e(f),{modelValue:e(l).branding.secondaryColor,"onUpdate:modelValue":a[7]||(a[7]=n=>e(l).branding.secondaryColor=n),label:"Secondary color (hex)"},null,8,["modelValue"])]),_:1})])):e(m)==="modules"?(s(),r("div",te,[u(e(B),null,{default:g(()=>[a[10]||(a[10]=t("h3",null,"Modules",-1)),(s(!0),r(M,null,F(e(p)?.modules??[],n=>(s(),r("div",{key:n.id,class:"admin__module"},[t("span",null,y(e(w)[n.id]?.label??n.id),1),u(e(ee),{modelValue:e(l).modulesById[n.id],"onUpdate:modelValue":b=>e(l).modulesById[n.id]=b,label:n.enabled?"On":"Off"},null,8,["modelValue","onUpdate:modelValue","label"])]))),128))]),_:1})])):v("",!0),t("div",de,[u(e(E),{variant:"primary",disabled:e(k),onClick:U},{default:g(()=>[...a[11]||(a[11]=[S(" Save ",-1)])]),_:1},8,["disabled"]),e(V)?(s(),r("p",se,y(e(V)),1)):v("",!0)])])]),_:1}))}}),ce=C(re,[["__scopeId","data-v-4d973ead"]]);export{ce as default};
