import{u as S}from"./Bg9r2jCQ.js";import{f as A,h as t,i as h}from"./DhkfeLsH.js";function B(d){const{slug:v,page:p=t(1),limit:g=24,collection:r=t(null),search:c=t("")}=d,w=S(),o=t([]),i=t(0),s=t(null),u=t(!1),m=t(null),y=h(()=>new Set(s.value?.mints??[])),M=h(()=>{const a=new Map;for(const e of s.value?.entries??[])if(e.collectionMint){const n=a.get(e.collectionMint)??[];n.push(e.mint),a.set(e.collectionMint,n)}return a});async function f(){const a=v.value;if(!a){o.value=[],i.value=0,s.value=null;return}u.value=!0,m.value=null;try{const e=new URLSearchParams;e.set("page",String(p.value)),e.set("limit",String(g)),r.value&&e.set("collection",r.value),c.value?.trim()&&e.set("search",c.value.trim());const n=await fetch(`${w.value}/api/v1/tenant/${encodeURIComponent(a)}/marketplace/assets?${e}`);if(!n.ok)throw new Error(`HTTP ${n.status}`);const l=await n.json();o.value=Array.isArray(l.assets)?l.assets:[],i.value=l.total??0,s.value=l.scope?{mints:l.scope.mints??[],entries:l.scope.entries??[]}:null}catch(e){m.value=e instanceof Error?e.message:"Failed to load assets",o.value=[],i.value=0,s.value=null}finally{u.value=!1}}return A([v,p,r,c],()=>f(),{immediate:!0}),{assets:o,total:i,scope:s,mintsSet:y,mintsByCollection:M,loading:u,error:m,retry:f}}export{B as u};
